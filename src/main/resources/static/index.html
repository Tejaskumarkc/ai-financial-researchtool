<!DOCTYPE html>
<html>
<head>
    <title>AI Financial Research Tool</title>
    <style>
        body{
         font-family:Arial;
         background:#0f172a;
         color:white;
         text-align:center;
         padding-top:60px;
        }
        .box{
         background:#111827;
         padding:40px;
         width:500px;
         margin:auto;
         border-radius:12px;
         box-shadow:0 0 20px rgba(0,0,0,0.5);
        }
        button{
         padding:12px 25px;
         background:#22c55e;
         border:none;
         color:white;
         font-size:16px;
         border-radius:8px;
         cursor:pointer;
        }
        button:hover{
         background:#16a34a;
        }
    </style>
</head>

<body>

<div class="box">
    <h2>ðŸ“Š AI Financial Statement Extractor</h2>
    <p>Upload Annual Report â†’ Get Excel Ready Data</p>

    <form id="form">
        <input type="file" name="file" required/>
        <br><br>
        <button type="submit">Extract to Excel</button>
    </form>

    <p id="msg"></p>
</div>

<script>
    document.getElementById("form").onsubmit = async (e)=>{
     e.preventDefault();
     document.getElementById("msg").innerText="Analyzing financial report...";

     let formData = new FormData(e.target);

     let res = await fetch("/api/extract",{
       method:"POST",
       body:formData
     });

     let blob = await res.blob();
     let url = window.URL.createObjectURL(blob);

     let a = document.createElement("a");
     a.href = url;
     a.download = "financial_data.csv";
     a.click();

     document.getElementById("msg").innerText="Excel downloaded âœ…";
    }
</script>

</body>
</html>
